_____________________

ACTIVE RECONNAISSANCE
_____________________

Port Scans
----------

Le scan des ports est essentiel car il renseigne sur les ports ouverts et qui peuvent êtres exploités.

Nmap SYN Scan :
______________________________________________________________________________
Namp port status|  Response from target |  Nmap Analysis		      |
----------------|-----------------------|-------------------------------------|
Open		|	TCP SYN/ACK	|  Le service est en mode listening   |
		|			|				      |
Close		|	TCP RST	        |  Le service n'est pas en listening  |
		|			|				      |
Filtered 	|	Pas de réponse  |  Impossible de savoir si le port est|
		|			|  ouvert ou fermé		      |
________________|_______________________|_____________________________________|


Nmap Scan types
---------------

- Many informations (-A)
- TCP Connect Scan (-sT) : Utilisé par défaut si aucune options n'a été définit. Il prend plus de temps
- UDP Scan (-sU)
- TCP FIN Scan (-sF) : pour ce type de scan, les windows ne répondent pas 
- Host discovery Scan (-sn)
- Timing Options (-T 0-5) : il determine l'agressivité du scan
	-T0 (Paranoid)  : vraiment lent, utilisé pour ne pas être découvert par les IDS
	-T1 (Sneaky)    : un peu lent, utilisé pour ne pas être découvert par les IDS
	-T2 (Polite)    : vas lentement pour consommer moins de bande passante. 10x plus lent que le T3
	-T3 (Normal)    : Utilisé par défaut, il est dynamique en fonction des réponses
	-T4 (Aggressive): Rapide et efficace
	-T5 (Insane)    : Très rapide et peu surcharger la cible
- OS detection (-O) 
- Version Scan (-sV)


Types of enumeration
--------------------

+ Enumération des hôtes
	- On peut utiliser Nmap et Masscan
	# nmap -sn <sous-réseau>

+ Enumération des utilisateurs
	- La recherches des nom d'utilisateurs exerçants dans l'organisation permet de réaliser une Brute Force Attack
	- Dans un environnement, cela peut se faire par la manipulation du SMB (Server Message Block)
	# nmap --script smb-enum-users.nse <host>							--> ce script permet de révéler le username d'un hôte

+ Enumération des Groups
	- L'énumération des groups permet de déterminer les rôles et authorisations présents dans le l'environnement de la cible
	# nmap --script smb-enum-groups.nse -p 445 <host>						--> ce script permet de lister les groups sur la machine distante
	# nmap --script smb-enum-groups.nse --script-args smbusername=vagrant,smbpass=vagrant <host>	--> énumerer les groups et users en connaissant les credentials du smd

+ Enumération des des partages réseaux
	- Identifier les équipements qui partagent les fichiers, dossiers et imprimantes permet de mettre en place une surface d'attaque
	# nmap --script smb-enum-shares.nse -p 445 <host>						--> Enumération du partage SMB
	# nmap -sC <host> 										--> Permet d'avoir plus d'informations sur sur le service et OS utilisé
	# enum4linux <host>										--> Permet de faire une énumération sur le partage Samba sur Linux

+ Enumération des sites et applications webs
	- Une fois qu'on identifie que la cible est un serveur web, on passe à l'énumération des applications webs pour trouver une surface d'attaque
	- Nmap fourni un script qui permet de faire une cartographie de la surface d'attaque
	# nmap -sV --script=http-enum <cible>								--> fournit les infos sur le serveur web et les répertoires. C'est un bon début!!!
	# nikto -h <cible>										--> fournit les même infos mais cette fois en utilisant Nikto

+ Enumération des services
	- Ce procédé consiste à identifier les services en cours d'exécution sur la machine distante
	# nmap --script smb-enum-processes.nse --script-args smbusername=<username>,smbpass=<password> -p 445 <host>

+ Enumération des services via l'élaboration de packet (Packet Crafting)
	- Scapy est l'outil favori pour l'énumération via génération de paquets
	# sudo scapy											--> pour lancer scapy
	>>> send(IP(dst="ip_cible")/ICMP()/"malicious_payload")						--> génération d'un paquet ICMP
	# sudo tshark host <cible>									--> récupération des paquets générés avec tshark
	
	














